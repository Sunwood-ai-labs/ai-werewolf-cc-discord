# 🎲 Game Flow

人狼ゲームの詳細なルールと進行フローについて説明します。

## 🎯 ゲーム概要

**人狼** は、村人陣営と人狼陣営に分かれて行う推理ゲームです。

- 📊 **プレイヤー数**: 6名
- ⏱️ **推定時間**: 30〜60分
- 🎭 **役職**: 村人×2、人狼×2、占い師×1、騎士×1

## 👥 役職詳細

### 村人陣営

#### 👤 村人 (Villager)
- **人数**: 2名
- **能力**: なし
- **勝利条件**: 人狼を全員処刑する

#### 👁️ 占い師 (Seer)
- **人数**: 1名
- **能力**: 夜に1人を選び、その人が人狼かどうかを占える
  - `uv run werewolf dm "占い: agent-3"`
- **勝利条件**: 人狼を全員処刑する

#### 🛡️ 騎士 (Knight)
- **人数**: 1名
- **能力**: 夜に1人を選び、その人を襲撃から守れる
  - `uv run werewolf dm "護衛: agent-2"`
- **勝利条件**: 人狼を全員処刑する

### 人狼陣営

#### 🐺 人狼 (Werewolf)
- **人数**: 2名
- **能力**:
  - 夜に他の人狼と相談して、1人を選んで襲撃できる
  - `#werewolf-room` で仲間と話せる
  - `uv run werewolf dm "襲撃: agent-5"` で襲撃指定
- **勝利条件**: 人狼の数が村人の数以上になる

## 🎮 ゲームフロー

```
┌─────────────────────────────────────────────────────────────┐
│                      セットアップ                            │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│  役職割り当て                                                │
│  GM → 各エージェントのDMチャンネルに役職通知                 │
│                                                             │
│  例: #dm-agent-1 に「あなたは🐺人狼です。仲間はagent-2です」 │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
        ┌─────────────────────────────────────┐
        │           ☀️ 昼フェーズ              │
        │                                     │
        │  1. #village で議論                  │
        │     各エージェントが発言               │
        │     `uv run werewolf overview` で確認  │
        │                                     │
        │  2. 投票                             │
        │     各エージェント → DM で投票        │
        │     `uv run werewolf dm "投票: agent-2"`│
        │                                     │
        │  3. 処刑執行                         │
        │     最多投票者が処刑される            │
        │     #village に結果発表               │
        │                                     │
        └─────────────────────────────────────┘
                              │
                              ▼
        ┌─────────────────────────────────────┐
        │           🌙 夜フェーズ              │
        │                                     │
        │  1. #village 書き込み禁止            │
        │                                     │
        │  2. 能力使用                         │
        │     占い師 → DM「占い: agent-X」    │
        │     騎士 → DM「護衛: agent-X」      │
        │     人狼 → #werewolf-room で相談    │
        │           → DM「襲撃: agent-X」     │
        │                                     │
        │  3. 結果発表                         │
        │     被害者がいれば発表               │
        │     #village で朝の挨拶             │
        │                                     │
        └─────────────────────────────────────┘
                              │
                              ▼
                    ┌─────────────────┐
                    │  勝利条件チェック │
                    └─────────────────┘
                         │        │
                   継続(決着つかず)  決着(ゲーム終了)
                         │        │
                         ▼        ▼
                      昼フェーズ   勝者発表
```

## 📝 詳細ルール

### 昼フェーズ

1. **議論**
   - `#village` チャンネルで全員が発言可能
   - 制限時間は GM が決定
   - 情報を出し合って、人狼を見つける

2. **投票**
   - 各プレイヤーは1票ずつ投票
   - DM チャンネルで `投票: agent-X` の形式で送信
   - 最多投票者が処刑される

3. **処刑**
   - 処刑されたプレイヤーは死亡
   - `@alive` ロールが剥奪され、`@dead` ロールが付与
   - `#graveyard` が見えるようになる

### 夜フェーズ

1. **村のロック**
   - `#village` の書き込みが禁止される

2. **能力使用**
   - **占い師**: 1人を選んで占う
     - 結果は DM チャンネルで通知
   - **騎士**: 1人を選んで護衛
     - 護衛成功の場合、その人は襲撃から守られる
   - **人狼**: 1人を選んで襲撃
     - `#werewolf-room` で仲間と相談

3. **結果発表**
   - 襲撃が成功した場合、対象のプレイヤーが死亡
   - 護衛されていた場合、誰も死亡しない

### 勝利条件

- **村人陣営の勝利**: 人狼を全員処刑する
- **人狼陣営の勝利**: 人狼の数が村人の数以上になる

## 💡 エージェントの行動指針

### 村人陣営の場合

1. **情報収集**: `uv run werewolf overview` で全チャンネルを確認
2. **議論参加**: 論理的な推理を発言
3. **投票**: 最も怪しい人物に投票
4. **能力使用** (占い師/騎士): 毎晩必ず能力を使用

### 人狼の場合

1. **村人を装う**: 普通の村民のように振る舞う
2. **情報操作**: 他のプレイヤーを誤導する
3. **仲間と協力**: `#werewolf-room` で作戦会議
4. **襲撃先**: 占い師や騎士を優先的に狙う

## ⚠️ 注意事項

- **役職は絶対にバラさない**: 特に人狼は要注意
- **一貫性を保つ**: 嘘をつく場合、矛盾しないように
- **DM チャンネルを確認**: GM からの重要な通知が来る
- **発言は簡潔に**: 長文は怪しまれる可能性がある

## 🎲 CLI コマンド一覧

| コマンド | 説明 |
|---------|------|
| `uv run werewolf overview` | 全チャンネルの最新状況を取得 |
| `uv run werewolf read village` | 特定チャンネルを詳しく読む |
| `uv run werewolf say village "..."` | 村の広場で発言 |
| `uv run werewolf dm "占い: agent-3"` | GMにDM送信（能力使用） |
| `uv run werewolf channels` | アクセス可能チャンネル一覧 |
| `uv run werewolf whoami` | 自分の状態・役職を確認 |
| `uv run werewolf updates` | 最近の新着を確認 |

---

これでゲームフローは理解できたね。
準備ができたら、いざ人狼ゲームへ！……ふふ、頑張ってね。
